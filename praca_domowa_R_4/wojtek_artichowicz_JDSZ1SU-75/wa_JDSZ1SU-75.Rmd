---
title: "Correspondence analysis of mtcars dataset"
author: "Wojciech Artichowicz"
date: "7 maja 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(FactoMineR)
library(factoextra)
library(gplots)
library(ggplot2)
```


### Conclusions for stakeholder
#### Based on PCA

* Car models which are close on the plot are similar in terms of examined parameters (mpg,disp,hp,drat,wt,qsec);
* This means that if we want to aim our product at specified customer, we should point with designed car models parameters to be close to one of the groups;
* On the other hand one should take into consideration technical solutions used in particular car type. For example if we want to design a new fast sports car, then solutions similar to ones used in Maserati Bora and Ford Pantera L should be a good first guess; In such case one should possibly take into consideration why those cars have different number of carburetors with similar other parameter values

#### Based on CA of cylinders vs. carburetors
* Commonly used engines have 4 or 8 cylinders and 4 carburetors - that is a hint for design;
* Usually 2 or 4 carburetors are used - ask mechanician for explanation why;
* Only fast and expensive carshave number of cylinders equal to number of carburetors;
* In general number of carburetors is lower than the number of cylinders - if our company points toward existing market, it should be considered;

#### Based on CA of gears vs. carburetors
* Usually cars have 3 or 4 gears along with 1 to 4 carburetors - that is typical if we want to create popular new car;
* Five gears come along with 6 or 8 carburetors in expensive sport cars - hint if we want to aim into exclusive market; 
* Middle class expensive sports cars, have 5 gears with 2 carburetors - popular sports car;
* In CA factor map 6 and 8 carburetors are placed in the same point and are the close to 5 gears.

### Data science part

```{r cars}
data("mtcars")  #loading dataset
head(mtcars,5)
```

### 1. General PCA performed on the dataset

#### Remark
To search for possible correlation dependencies PCA was performed on continuous and ordinal variables. Categorical variables were neglected.

#### Data science comment
PCA creates a new projection of the features in such way that new features are not correlated.
Arrows (noted with variables) on the plot show correlations. Arrows pointing along similarly sloped lines are correlated. If the arrow heads are in the same direction, they are correlated positively, otherwise negatively.

Variables (for example car entities) ploted on such plot depict the poistion of that points in the new features space projected onto plane of chosen directions. If points are close they are somewhat similar, if they are far they significantly different.

Scree plot shows the amount of information in each of the new variables.For example here ~60% of the total dataset variability is "compressed" into first PCA.

Contribution plots show how strong is the influence of each variable to given new feature.

Similar explanations hold for correspondence analysis.

```{r PCA circle plot}
   PCAreduced <- PCA(mtcars[c("mpg","disp","hp","drat","wt","qsec")], scale.unit = TRUE, ncp = 6, graph = FALSE)

print(PCAreduced$eig)

fviz_pca_biplot(PCAreduced)

fviz_screeplot(PCAreduced)
fviz_contrib(PCAreduced,choice = "var",axes = 1, top = 10)  #dim 1
fviz_contrib(PCAreduced,choice = "var",axes = 2, top = 10)  #dim 2
```


### 2. Correspondence analysis of three pairs of fields

Correspondence analysis is performed for categorcal and ordinal variables, therefore following pairs were chosen:

* cylinders and carburetors
* gear vs. carburetors
* cylinders vs. gear

#### 2.1. Cylinders vs. carburetors

Baloonplot shows that the most commonly used engines have 4 or 8 cylinders and 4 carburetors. Usually 2 or 4 carburetors are used. Further examination leads to the following conclusion:
Only Ferrari Dino and Maserati Bora have number of cylinders equal to number of carburetors.
Usually number of carburetors is lower than the number of cylinders. 

CA biplot shows that all engine configurations are far one from another except the ones that have 3 or 8 carburetors.
```{r Cylinders vs. carburetors, echo=FALSE}
mtcars.tab <- table(mtcars[[2]],mtcars[[11]])
balloonplot(t(mtcars.tab),main = "cyl vs. carb",xlab = "", ylab = "",label = TRUE,show.margins = FALSE)

ca_result <- CA(mtcars.tab,graph = TRUE) # show plot
fviz_ca_biplot(ca_result,col.row = "contrib") 

print(ca_result$eig[,c(2,3)]) # show contributions in the new feature space
fviz_screeplot(ca_result)
fviz_contrib(ca_result,choice = "row",axes = 1, top = 10)  #dim 1
fviz_contrib(ca_result,choice = "row",axes = 2, top = 10)  #dim 2
```

### 2.2. gear vs. carburetors

Balloonplot depicts that most commonly analysed cars have 3 or 4 gears along with 1 to 4 carburetors.Five gears come along with 6 or 8 carburetors. However two entities have 2 carburetors and 5 gears.Both are middle class cars - expensive sports cars, but not exclusive.

CA factor map indicates that engines with 6 and 8 carburetors are placed in the same point and are the close to 5 gears.

```{r gear vs. carburetors, echo=FALSE}
mtcars.tab <- table(mtcars[[10]],mtcars[[11]])
balloonplot(t(mtcars.tab),main = "gear vs. carb",xlab = "", ylab = "",label = TRUE,show.margins = FALSE)

ca_result <- CA(mtcars.tab,graph = TRUE) # show plot
fviz_ca_biplot(ca_result,col.row = "contrib") 

print(ca_result$eig[,c(2,3)]) # show contributions in the new feature space
fviz_screeplot(ca_result)
fviz_contrib(ca_result,choice = "row",axes = 1, top = 10)  #dim 1
fviz_contrib(ca_result,choice = "row",axes = 2, top = 10)  #dim 2
```

### 2.3. Cylinders vs. gear

Balloonplot shows that most cars have 8 cylinders and 3 carburetors, another popular setting is 4 cylinders with 4 carburetors.

Contribution plots show that the least variability is delivered by 6 cylinders and 8 carburetors. The strong data variability exists only in PCA1 direction. Points denoting 8 carburetors and 3 cylinders are close. Similarly points denoting 4 carburetors and 4 cylinders are close. That shows that these are the typcal constructions.


```{r cylinders vs. gear, echo=FALSE}
mtcars.tab <- table(mtcars[[2]],mtcars[[10]])
balloonplot(t(mtcars.tab),main = "cyl vs. carb",xlab = "", ylab = "",label = TRUE,show.margins = FALSE)

ca_result <- CA(mtcars.tab,graph = TRUE) # show plot
fviz_ca_biplot(ca_result,col.row = "contrib") 

print(ca_result$eig[,c(2,3)]) # show contributions in the new feature space
fviz_screeplot(ca_result)
fviz_contrib(ca_result,choice = "row",axes = 1, top = 10)  #dim 1
fviz_contrib(ca_result,choice = "row",axes = 2, top = 10)  #dim 2
```