geom_point(show_guide = FALSE) + facet_wrap(~STATE.COUNTRY.ID, col=)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID,scales="free")
source('~/Projects/GIT/DATA_SCIENCE/jdsz1-sqluci/PROJEKT_R2/wojtek/ww2temp/scratchpad.R')
corr_ceof
library(tidyverse)
library(ggmap)
library(maps)
library(mapdata)
df_stations <- read.csv("data/Weather Station Locations.csv")
head(df_stations,3)
nt <- table(df_stations$NAME)
nt[nt>1]
df_stations[df_stations$NAME == "BASTIA/CORSICA" | df_stations$NAME == "SAN JOSE",]
wrld <- map_data("world")
ggplot() + geom_polygon(data = wrld, aes(x=long, y = lat, group = group)) +
geom_point(data = df_stations, aes(x = Longitude, y = Latitude, col = STATE.COUNTRY.ID)) +
geom_text(data = df_stations, aes(x = Longitude, y = Latitude, col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0) +
scale_fill_discrete(guide=FALSE) + scale_color_discrete(guide = FALSE)
df_weather <-  read.csv("data/Summary of Weather.csv")
head(df_weather,3)
df_weather$STA <- as.factor(df_weather$STA) #Set weather station as factor
ggplot(df_weather,aes(x = MinTemp, y = MaxTemp, col = STA)) +
geom_point() + scale_colour_discrete(guide = FALSE)
df_all <- merge(x = df_weather, y = df_stations, by.x = "STA", by.y = "WBAN")
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point()
df_all <- df_all[df_all$MinTemp < df_all$MaxTemp & !(df_all$MaxTemp > 11 & df_all$MinTemp > -20 & df_all$MinTemp < -10),]
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() #+ geom_text(aes(col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID,scales="free")
corr_ceof
u_state_ID <-  unique(df_all$STATE.COUNTRY.ID)
cor_coef <- rep(NA,length(u_state_ID))
i <- 0
for (id in u_state_ID)
{
i<-i+1
mmT <- df_all[df_all$STATE.COUNTRY.ID == id,c("MinTemp","MaxTemp")]
cor_coef[i] <- cor(mmT$MinTemp,mmT$MaxTemp)
}
cor(df_all[,c("MinTemp","MaxTemp")]) # global correlation coefficient seems fine
lin_model_global <- lm(MaxTemp ~ MinTemp,data = df_all)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot(df_all) +
geom_density(aes(x = MinTemp)) + geom_density(aes(x = MaxTemp))
ggplot(df_all) +
geom_boxplot(outlier.colour="black", outlier.shape=16,
outlier.size=2, notch=FALSE)
ggplot(df_all) +
geom_boxplot(aes(x = MinTemp), outlier.colour="black", outlier.shape=16,
outlier.size=2, notch=FALSE)
ggplot(df_all) +
geom_boxplot(aes(y = MinTemp), outlier.colour="black", outlier.shape=16,
outlier.size=2, notch=FALSE)
ggplot(df_all) +
geom_boxplot(aes(x = "Min",y = MinTemp), outlier.colour="black", outlier.shape=16,
outlier.size=2, notch=FALSE)
ggplot(df_all) +
geom_boxplot(aes(x = "Min",y = MinTemp), outlier.colour="black", outlier.shape=16,
outlier.size=2, notch=FALSE) +
geom_boxplot(aes(x = "Max",y = MaxTemp), outlier.colour="black", outlier.shape=16,
outlier.size=2, notch=FALSE)
df_weather[df_weather == NA]
df_weather[df_weather$MaxTemp == NA]
df_weather[df_weather$MaxTemp == NA,]
df_weather$MaxTemp == NA
length(df_weather$MaxTemp == NA)
length(df_weather$MaxTemp == NA | df_weather$MinTemp == NA)
length(df_weather$MaxTemp == NA | df_weather$MinTemp == NA)
df_weather <- df_weather[!(df_weather$MaxTemp == NA | df_weather$MinTemp == NA)]
df_weather <- df_weather[!(df_weather$MaxTemp == NA | df_weather$MinTemp == NA),]
is.na(df_weather$MaxTemp)
?is.na
anyNA(df_weather$MaxTemp)
df_weather <- df_weather[!(df_weather$MaxTemp == NA | df_weather$MinTemp == NA),]
anyNA(df_weather$MaxTemp)
length(df_weather$MaxTemp == NA | df_weather$MinTemp == NA)
library(tidyverse)
library(ggmap)
library(maps)
library(mapdata)
df_stations <- read.csv("data/Weather Station Locations.csv")
head(df_stations,3)
nt <- table(df_stations$NAME)
nt[nt>1]
df_stations[df_stations$NAME == "BASTIA/CORSICA" | df_stations$NAME == "SAN JOSE",]
wrld <- map_data("world")
ggplot() + geom_polygon(data = wrld, aes(x=long, y = lat, group = group)) +
geom_point(data = df_stations, aes(x = Longitude, y = Latitude, col = STATE.COUNTRY.ID)) +
geom_text(data = df_stations, aes(x = Longitude, y = Latitude, col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0) +
scale_fill_discrete(guide=FALSE) + scale_color_discrete(guide = FALSE)
df_weather <-  read.csv("data/Summary of Weather.csv")
length(df_weather$MaxTemp == NA | df_weather$MinTemp == NA)
df_weather <- df_weather[!(df_weather$MaxTemp == NA | df_weather$MinTemp == NA),]
length(df_weather$MaxTemp == NA | df_weather$MinTemp == NA)
length(df_weather)
nrow(df_weather)
is.na(df_weather)
is.na(df_weather$MaxTemp)
df_weather$MaxTemp
library(tidyverse)
library(ggmap)
library(maps)
library(mapdata)
df_stations <- read.csv("data/Weather Station Locations.csv")
head(df_stations,3)
nt <- table(df_stations$NAME)
nt[nt>1]
df_stations[df_stations$NAME == "BASTIA/CORSICA" | df_stations$NAME == "SAN JOSE",]
df_weather <-  read.csv("data/Summary of Weather.csv")
is.na(df_weather$MaxTemp)
any(is.na(df_weather$MaxTemp))
any(is.na(df_weather$MinTemp))
any(is.na(df_weather$MaxTemp))
corr_ceof
?sample
size = nrow(df_weather)
idx = sample_frac(1:size)
idx = sample(1:size)
idx
edge = integer(0.2*nrow(df_weather))
edge
0.2*nrow(df_weather)
?integer
edge = as.integer(0.2*nrow(df_weather))
edge
train = df_weather[idx[1:edge],]
test = df_weather[idx[edge+1:size],]
corr_ceof
u_state_ID <-  unique(df_all$STATE.COUNTRY.ID)
cor_coef <- rep(NA,length(u_state_ID))
i <- 0
u_state_ID <-  unique(df_all$STATE.COUNTRY.ID)
df_stations <- read.csv("data/Weather Station Locations.csv")
head(df_stations,3)
nt <- table(df_stations$NAME)
nt[nt>1]
df_stations[df_stations$NAME == "BASTIA/CORSICA" | df_stations$NAME == "SAN JOSE",]
df_weather <-  read.csv("data/Summary of Weather.csv")
any(is.na(df_weather$MinTemp))
any(is.na(df_weather$MaxTemp))
df_weather$STA <- as.factor(df_weather$STA) #Set weather station as factor
df_all <- merge(x = df_weather, y = df_stations, by.x = "STA", by.y = "WBAN")
df_all <- df_all[df_all$MinTemp < df_all$MaxTemp & !(df_all$MaxTemp > 11 & df_all$MinTemp > -20 & df_all$MinTemp < -10),]
u_state_ID <-  unique(df_all$STATE.COUNTRY.ID)
cor_coef <- rep(NA,length(u_state_ID))
i <- 0
for (id in u_state_ID)
{
i<-i+1
mmT <- df_all[df_all$STATE.COUNTRY.ID == id,c("MinTemp","MaxTemp")]
cor_coef[i] <- cor(mmT$MinTemp,mmT$MaxTemp)
}
meanMinTemp <- rep(NA,length(u_state_ID))
meanMaxTemp <- rep(NA,length(u_state_ID))
i <- 0
for (id in u_state_ID)
{
i<-i+1
mmT <- df_all[df_all$STATE.COUNTRY.ID == id,c("MinTemp","MaxTemp")]
cor_coef[i] <- cor(mmT$MinTemp,mmT$MaxTemp)
meanMinTemp[i] = mean(mmT$MinTemp)
meanMaxTemp[i] = mean(mmT$MaxTemp)
}
cor(meanMinTemp,meanMaxTemp)
ggplot(aes(x =meanMinTemp, y = meanMaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
cor(meanMinTemp,meanMaxTemp)
ggplot(aes(x =meanMinTemp, y = meanMaxTemp)) +
geom_point()
cor(meanMinTemp,meanMaxTemp)
ggplot(data.frame(meanMinTemp,meanMaxTemp),aes(x =meanMinTemp, y = meanMaxTemp)) +
geom_point()
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID,scales="free") +
ggplot(data.frame(meanMinTemp,meanMaxTemp),aes(x =meanMinTemp, y = meanMaxTemp)) +
geom_point()
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID,scales="free") +
geom_point(aes(x =meanMinTemp, y = meanMaxTemp))
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID,scales="free")
cor(meanMinTemp,meanMaxTemp)
ggplot(data.frame(meanMinTemp,meanMaxTemp),aes(x =meanMinTemp, y = meanMaxTemp)) +
geom_point()
ggplot(df_all,aes(x = MinTemp, y = MaxTemp)) +
geom_point() +
ggplot(data.frame(meanMinTemp,meanMaxTemp),aes(x =meanMinTemp, y = meanMaxTemp)) +
geom_point()
ggplot() +
geom_point(df_all,aes(x = MinTemp, y = MaxTemp)) +
geom_point(data.frame(meanMinTemp,meanMaxTemp),aes(x =meanMinTemp, y = meanMaxTemp))
ggplot() +
geom_point(df_all,aes(x = MinTemp, y = MaxTemp)) +
geom_point(data.frame(meanMinTemp,meanMaxTemp),aes(x =meanMinTemp, y = meanMaxTemp))
ggplot() +
geom_point(df_all,aes(x = MinTemp, y = MaxTemp))
ggplot() +
geom_point(df_all,aes(x = MinTemp, y = MaxTemp))
ggplot(df_all,aes(x = MinTemp, y = MaxTemp)) +
geom_point()
ggplot() +
geom_point(df_all,aes(x = MinTemp, y = MaxTemp))
ggplot() +
geom_point(data = df_all,aes(x = MinTemp, y = MaxTemp))
ggplot() +
geom_point(data = df_all,aes(x = MinTemp, y = MaxTemp)) +
geom_point(data = data.frame(meanMinTemp,meanMaxTemp),aes(x =meanMinTemp, y = meanMaxTemp),fill = red)
ggplot() +
geom_point(data = df_all,aes(x = MinTemp, y = MaxTemp)) +
geom_point(data = data.frame(meanMinTemp,meanMaxTemp),aes(x =meanMinTemp, y = meanMaxTemp),fill = 'red')
ggplot() +
geom_point(data = df_all,aes(x = MinTemp, y = MaxTemp, col = 'blue')) +
geom_point(data = data.frame(meanMinTemp,meanMaxTemp),aes(x =meanMinTemp, y = meanMaxTemp),fill = 'red')
library(tidyverse)
library(ggmap)
library(maps)
library(mapdata)
df_stations <- read.csv("data/Weather Station Locations.csv")
head(df_stations,3)
nt <- table(df_stations$NAME)
nt[nt>1]
df_stations[df_stations$NAME == "BASTIA/CORSICA" | df_stations$NAME == "SAN JOSE",]
wrld <- map_data("world")
ggplot() + geom_polygon(data = wrld, aes(x=long, y = lat, group = group)) +
geom_point(data = df_stations, aes(x = Longitude, y = Latitude, col = STATE.COUNTRY.ID)) +
geom_text(data = df_stations, aes(x = Longitude, y = Latitude, col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0) +
scale_fill_discrete(guide=FALSE) + scale_color_discrete(guide = FALSE)
df_weather <-  read.csv("data/Summary of Weather.csv")
any(is.na(df_weather$MinTemp))
any(is.na(df_weather$MaxTemp))
head(df_weather,3)
df_weather$STA <- as.factor(df_weather$STA) #Set weather station as factor
ggplot(df_weather,aes(x = MinTemp, y = MaxTemp, col = STA)) +
geom_point() + scale_colour_discrete(guide = FALSE)
df_all <- merge(x = df_weather, y = df_stations, by.x = "STA", by.y = "WBAN")
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point()
df_all <- df_all[df_all$MinTemp < df_all$MaxTemp & !(df_all$MaxTemp > 11 & df_all$MinTemp > -20 & df_all$MinTemp < -10),]
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() #+ geom_text(aes(col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point(show.legend = FALSE) + facet_wrap(~STATE.COUNTRY.ID,scales="free")
u_state_ID <-  unique(df_all$STATE.COUNTRY.ID)
cor_coef <- rep(NA,length(u_state_ID))
meanMinTemp <- rep(NA,length(u_state_ID))
meanMaxTemp <- rep(NA,length(u_state_ID))
i <- 0
for (id in u_state_ID)
{
i<-i+1
mmT <- df_all[df_all$STATE.COUNTRY.ID == id,c("MinTemp","MaxTemp")]
cor_coef[i] <- cor(mmT$MinTemp,mmT$MaxTemp)
meanMinTemp[i] = mean(mmT$MinTemp)
meanMaxTemp[i] = mean(mmT$MaxTemp)
}
cor(df_all[,c("MinTemp","MaxTemp")]) # global correlation coefficient seems fine
lin_model_global <- lm(MaxTemp ~ MinTemp,data = df_all)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
corr_ceof
i <- 0
for (id in u_state_ID)
{
i<-i+1
mmT <- df_all[df_all$STATE.COUNTRY.ID == id,c("MinTemp","MaxTemp")]
cor_coef[i] <- cor(mmT$MinTemp,mmT$MaxTemp)
meanMinTemp[i] = mean(mmT$MinTemp)
meanMaxTemp[i] = mean(mmT$MaxTemp)
}
cor(df_all[,c("MinTemp","MaxTemp")]) # global correlation coefficient seems fine
lin_model_global <- lm(MaxTemp ~ MinTemp,data = df_all)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
library(tidyverse)
library(ggmap)
library(maps)
library(mapdata)
df_stations <- read.csv("data/Weather Station Locations.csv")
head(df_stations,3)
nt <- table(df_stations$NAME)
nt[nt>1]
df_stations[df_stations$NAME == "BASTIA/CORSICA" | df_stations$NAME == "SAN JOSE",]
wrld <- map_data("world")
df_weather <-  read.csv("data/Summary of Weather.csv")
any(is.na(df_weather$MinTemp))
any(is.na(df_weather$MaxTemp))
head(df_weather,3)
df_weather$STA <- as.factor(df_weather$STA) #Set weather station as factor
ggplot(df_weather,aes(x = MinTemp, y = MaxTemp, col = STA)) +
geom_point() + scale_colour_discrete(guide = FALSE)
df_all <- merge(x = df_weather, y = df_stations, by.x = "STA", by.y = "WBAN")
meanMinTemp <- rep(NA,length(u_state_ID))
meanMaxTemp <- rep(NA,length(u_state_ID))
i <- 0
for (id in u_state_ID)
{
i<-i+1
mmT <- df_all[df_all$STATE.COUNTRY.ID == id,c("MinTemp","MaxTemp")]
cor_coef[i] <- cor(mmT$MinTemp,mmT$MaxTemp)
meanMinTemp[i] = mean(mmT$MinTemp)
meanMaxTemp[i] = mean(mmT$MaxTemp)
}
cor(df_all[,c("MinTemp","MaxTemp")]) # global correlation coefficient seems fine
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() #+ geom_text(aes(col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0)
df_all <- df_all[df_all$MinTemp < df_all$MaxTemp & !(df_all$MaxTemp > 11 & df_all$MinTemp > -20 & df_all$MinTemp < -10),]
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() #+ geom_text(aes(col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() ++ scale_colour_discrete(guide = FALSE) #+ geom_text(aes(col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0)
ggplot(df_all,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() + scale_colour_discrete(guide = FALSE) #+ geom_text(aes(col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0)
cor(meanMinTemp,meanMaxTemp)
cor(df_all[,c("MinTemp","MaxTemp")]) # global correlation coefficient seems fine
corr_ceof
cor(df_all[,c("MinTemp","MaxTemp")]) # global correlation coefficient seems fine
0.873741^2
i <- 0
for (id in u_state_ID)
{
i<-i+1
mmT <- df_all[df_all$STATE.COUNTRY.ID == id,c("MinTemp","MaxTemp")]
cor_coef[i] <- cor(mmT$MinTemp,mmT$MaxTemp)
meanMinTemp[i] = mean(mmT$MinTemp)
meanMaxTemp[i] = mean(mmT$MaxTemp)
}
ggplot(mmT,aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot(mmT,aes(x = MinTemp, y = MaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot(aes(x = meanMinTemp, y = meanMaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot(aes(data.frame(meanMinTemp, meanMaxTemp), x = meanMinTemp, y = meanMaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot(data.frame(meanMinTemp, meanMaxTemp),aes(, x = meanMinTemp, y = meanMaxTemp, col = STATE.COUNTRY.ID)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot() +
geom_point(data = data.frame(meanMinTemp,meanMaxTemp,u_state_ID),aes(x =meanMinTemp, y = meanMaxTemp,col = u_state_ID))
+ scale_colour_discrete(guide = FALSE)
ggplot() +
geom_point(data = data.frame(meanMinTemp,meanMaxTemp,u_state_ID),aes(x =meanMinTemp, y = meanMaxTemp,col = u_state_ID)) +
scale_colour_discrete(guide = FALSE)
wrld <- map_data("world")
ggplot() + geom_polygon(data = wrld, aes(x=long, y = lat, group = group)) +
geom_point(data = df_stations, aes(x = Longitude, y = Latitude, col = STATE.COUNTRY.ID)) +
geom_text(data = df_stations, aes(x = Longitude, y = Latitude, col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0) +
scale_fill_discrete(guide=FALSE) + scale_color_discrete(guide = FALSE)
wrld <- map_data("world")
wrld <- map_data("world")
ggplot() + geom_polygon(data = wrld, aes(x=long, y = lat, group = group)) +
geom_point(data = df_stations, aes(x = Longitude, y = Latitude, col = STATE.COUNTRY.ID)) +
#geom_text(data = df_stations, aes(x = Longitude, y = Latitude, col = STATE.COUNTRY.ID,label=STATE.COUNTRY.ID),hjust=0, vjust=0) +
scale_fill_discrete(guide=FALSE) + scale_color_discrete(guide = FALSE)
minTa = 15
minTb = 20
maxTa = 20
maxTb = 30
lsdf = data.frame(meanMinTemp,meanMaxTemp,u_state_ID);
lsdf
lsdf[(lsdf$meanMinTemp >= minTa & lsdf$meanMinTemp <= minTb) &
(lsdf$meanMaxTemp >= maxTa & lsdf$meanMaxTemp <= maxTb)]
lsdf[(lsdf$meanMinTemp >= minTa & lsdf$meanMinTemp <= minTb) & (lsdf$meanMaxTemp >= maxTa & lsdf$meanMaxTemp <= maxTb)]
minTa = 15
minTb = 20
maxTa = 20
maxTb = 30
lsdf[(lsdf$meanMinTemp >= minTa & lsdf$meanMinTemp <= minTb) ]
lsdf[("meanMinTemp" >= minTa & "meanMinTemp" <= minTb) & ("meanMaxTemp" >= maxTa & "meanMaxTemp" <= maxTb)]
lsdf[("meanMinTemp" >= minTa & "meanMinTemp" <= minTb) ]
lsdf[("meanMinTemp" >= minTa & "meanMinTemp" <= minTb) & ("meanMaxTemp" >= maxTa & "meanMaxTemp" <= maxTb),]
lsdf[("meanMinTemp" >= minTa & "meanMinTemp" <= minTb),]
lsdf[(lsdf$meanMinTemp >= minTa & lsdf$meanMinTemp <= minTb) & (lsdf$meanMaxTemp >= maxTa & lsdf$meanMaxTemp <= maxTb),]
df_all$STATE.COUNTRY.ID
df_all$NAME
unique(df_all[c("STATE.COUNTRY.ID", "NAME")])
unique(df_all[c("STATE.COUNTRY.ID", "NAME")]) == "PR"
unique(df_all[c("STATE.COUNTRY.ID", "NAME")])
?lm
colnames(df_all)
N = nrow(df_all)
scrambled_index <- sample(1:N)
edge <- round(0.8 *N)
train <- scrambled_index[1:edge]
test <- scrambled_index[(edge+1):N]
var <- c("MinTemp","MaxTemp")
train.df <- cdf[var]
train.df <- df_all[var]
model <- lm(MaxTemp = MinTemp.,data=train.df)
model <- lm(MaxTemp = MinTemp,data=train.df)
train.df
head(train.df)
model <- lm(MaxTemp ~ MinTemp,data=train.df)
summary(model)
anova(model, test="Chisq")
test.df <- df_all[test,var]
maxTpred <- predict(model,newdata=test.df,type='response')
outdf = data_frame(pred = predict(model,newdata=test.df,type='response'), obs = test.df$MaxTemp)
geom_point(data = outdf,aes(x =obs, y = pred)
ggplot() +
geom_point(data = outdf,aes(x =obs, y = pred)
)
outdf$pred
outdf$obs
ggplot() +
geom_point(data = outdf,aes(x =obs, y = pred))
model$coefficients
model$coefficients[1]
model$coefficients[[1]
]
ggplot(data = outdf) +
geom_point(aes(x =obs, y = pred)) +
geom_abline(aes(intercept=model$coefficients[[1]], slope=model$coefficients[[2]]), data=df)
ggplot(data = outdf) +
geom_point(aes(x =obs, y = pred)) +
geom_abline(aes(intercept=model$coefficients[[1]], slope=model$coefficients[[2]]))
ggplot(data = outdf) +
geom_point(aes(x =obs, y = pred)) +
geom_abline(aes(intercept=model$coefficients[[2]], slope=model$coefficients[[1]]))
summary(model)
anova(model, test="Chisq")
test.df <- df_all[test,var]
maxTpred <- predict(model,newdata=test.df,type='response')
outdf = data_frame(pred = predict(model,newdata=test.df,type='response'), obs = test.df$MaxTemp)
ggplot(data = outdf) +
geom_point(aes(x =obs, y = pred)) +
geom_abline(aes(intercept=model$coefficients[[1]], slope=model$coefficients[[2]]))
test.df <- df_all[test,var]
maxTpred <- predict(model,newdata=test.df,type='response')
outdf = data_frame(pred = predict(model,newdata=test.df,type='response'), obs = test.df$MaxTemp, MinTemp = test.df$MinTemp)
ggplot(data = outdf) +
geom_point(aes(x =MinTemp, y = pred)) +
geom_point(aes(x =MinTemp, y = obs)) +
geom_abline(aes(intercept=model$coefficients[[1]], slope=model$coefficients[[2]]))
ggplot(data = outdf) +
geom_point(aes(x =MinTemp, y = obs)) +
geom_abline(aes(intercept=model$coefficients[[1]], slope=model$coefficients[[2]]))
ggplot(data = outdf) +
geom_point(aes(x = MinTemp, y = obs)) +
geom_abline(aes(intercept=model$coefficients[[1]], slope=model$coefficients[[2]]))
ggplot(data = outdf) +
geom_point(aes(x = MinTemp, y = obs)) +
geom_abline(aes(intercept=model$coefficients[[1]], slope=model$coefficients[[2]],col = "red"))
ggplot(data = outdf) +
geom_point(aes(x = MinTemp, y = obs)) +
geom_abline(aes(intercept=model$coefficients[[1]], slope=model$coefficients[[2]],col = "red",size = 2))
ggplot(data = outdf) +
geom_point(aes(x = MinTemp, y = obs)) +
geom_abline(aes(intercept=model$coefficients[[1]], slope=model$coefficients[[2]],col = "red",size = 1))
ggplot(data = outdf) +
geom_point(aes(x = MinTemp, y = obs)) +
geom_abline(aes(intercept=model$coefficients[[1]], slope=model$coefficients[[2]],col = "red"))
(outdf$pred-outdf$obs)^2
MSE = mean((outdf$pred-outdf$obs)^2)
MRSE = sqrt(MSE)
lsdf
ggplot(lsdf,aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x) + facet_wrap(~u_state_ID)
lsdf[(lsdf$meanMinTemp >= minTa & lsdf$meanMinTemp <= minTb) & (lsdf$meanMaxTemp >= maxTa & lsdf$meanMaxTemp <= maxTb),]
df_all
head(df_all)
ggplot(df_all[df_all$STATE.COUNTRY.ID == reg,],aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
reg = "CS"
ggplot(df_all[df_all$STATE.COUNTRY.ID == reg,],aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
reg = "AU"
ggplot(df_all[df_all$STATE.COUNTRY.ID == reg,],aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
reg = "CU"
ggplot(df_all[df_all$STATE.COUNTRY.ID == reg,],aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
?any
lsdf[(lsdf$meanMinTemp >= minTa & lsdf$meanMinTemp <= minTb) & (lsdf$meanMaxTemp >= maxTa & lsdf$meanMaxTemp <= maxTb),]
ggplot(df_all[any(df_all$STATE.COUNTRY.ID == reg),],aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x)
ggplot(df_all[any(df_all$STATE.COUNTRY.ID == reg),],aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x) + facet_wrap(~STATE.COUNTRY.ID)
cond <- df_all$STATE.COUNTRY.ID == "CS" |
df_all$STATE.COUNTRY.ID == "GU" |
df_all$STATE.COUNTRY.ID == "BE" |
df_all$STATE.COUNTRY.ID == "HI" |
df_all$STATE.COUNTRY.ID == "PR" |
df_all$STATE.COUNTRY.ID == "TO" |
df_all$STATE.COUNTRY.ID == "AU"
ggplot(df_all[cond,],aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x) + facet_wrap(~STATE.COUNTRY.ID)
ggplot(df_all[cond,],aes(x = MinTemp, y = MaxTemp)) +
geom_point() + geom_smooth(method='lm',formula=y~x) + facet_wrap(~STATE.COUNTRY.ID,scales="free")
